select * from dbo.geometry_columns;

select * from dbo.spatial_ref_sys;




select * from guest.add_coastline_medium_res_line_v7_8;

-- 6 
select geom, geom.STAsText() from guest.add_coastline_medium_res_line_v7_8;
--MULTILINESTRING ((-1719780.5491000004 -396987.85920000076, -1719825.9873000011 -397326.12150000036, 
---1719693.0384000018 -397649.23779999837, -1719612.259300001 -397595.38509999961,
---1719529.7974000014 -397258.80559999868, -1719647.6002000012 -396987.85920000076, 
---1719780.5491000004 -396987.85920000076))



-------------------------------------------------------------------------
SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'dbo'
-------------------------------------------------------------------------
SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE  DATA_TYPE = 'geometry'


SELECT 
    t.name AS table_name,
    c.name AS column_name,
    ty.name AS data_type
FROM 
    sys.columns c
JOIN 
    sys.tables t ON c.object_id = t.object_id
JOIN 
    sys.types ty ON c.system_type_id = ty.system_type_id
WHERE 
    ty.name IN ('geometry', 'geography')
-- 7 

select SRID from dbo.spatial_ref_sys;

-- 8 
select * from guest.ne_110m_geography_regions_polys;
select geom.STAsText() from guest.ne_110m_geography_regions_polys;

-- 
9 

select * from guest.ne_110m_geography_regions_polys;
select geom.STAsText() from guest.ne_110m_geography_regions_polys;

-- 10 
--Для выполнения операций с пространственными данными, вы можете использовать
--соответствующие функции пространственных запросов (Spatial Query Functions) в SQL Server, такие как
--STIntersects, STUnion, STContains, STSimplify, STAsText, STDimension, STLength, STArea, STDistance, и другие.

--10.1.	Нахождение пересечения пространственных объектов;
select top 100 obj1.geom, obj2.geom ,obj1.geom.STIntersection(obj2.geom) from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 ;


select top 100 obj1.geom.STIntersection(obj2.geom).STAsText()  Intersection1
from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 ;

select top 100 obj1.geom.STIntersection(obj2.geom).STAsText()  Intersection1
from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 where  obj1.geom.STIntersection(obj2.geom).STAsText() != 'GEOMETRYCOLLECTION EMPTY';

--10.2.	Нахождение объединения пространственных объектов; -- если не написать TOP то 2 минуты выполняеться запрос и выводит 29502 записи 
select top 100 obj1.geom, obj2.geom ,obj1.geom.STUnion(obj2.geom) from
[dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 ;


select top 100 obj1.geom, obj2.geom ,obj1.geom.STUnion(obj2.geom).STAsText()  
from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 ;

--10.3.	Нахождение вложенности пространственных объектов;


select top 1000 obj1.geom.STAsText(), obj2.geom.STAsText() ,
obj1.geom.STContains(obj2.geom) AS is_geometry1_contains_geometry2,
    obj2.geom.STContains(obj1.geom) AS is_geometry2_contains_geometry1

from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2
where obj1.geom.STContains(obj2.geom) = 1 or obj2.geom.STContains(obj1.geom) = 1;


--10.4.	Упрощение пространственного объекта;

select top 1 geom from [dbo].[10m_admin_0_map_units]; 

select top 1 geom.Reduce(0.9) from [dbo].[10m_admin_0_map_units]; 


select top 100 geom, geom.Reduce(0.01) from [dbo].[10m_admin_0_map_units]; 


select top 100 geom.STAsText(), geom.Reduce(0.01).STAsText() from [dbo].[10m_admin_0_map_units]; 

--10.5.	Нахождение координат вершин пространственного объектов;


select top 100 geom.STAsText(), 
geom.STPointN(1).STX AS x_coordinate,
geom.STPointN(1).STY AS y_coordinate from [dbo].[10m_admin_0_map_units]

--10.6.	Нахождение размерности пространственных объектов;
--Вот значения, которые может возвращать STDimension() и их значения:

--0: Точка. Объект представляет собой точку в пространстве.
--1: Линия. Объект представляет собой линию (например, отрезок или кривую).
--2: Поверхность. Объект представляет собой поверхность (например, полигон).
--3: Объем. Объект представляет собой трехмерный объем в пространстве.

select top 1000 geom.STAsText(),geom.STDimension() AS geometry_dimension from [dbo].[10m_admin_0_map_units]; 

--10.7.	Нахождение длины и площади пространственных объектов;

SELECT
    geom.STAsText() AS geometry,
    geom.STLength() AS geometry_length,
    geom.STArea() AS geometry_area
FROM
    [dbo].[10m_admin_0_map_units];

--10.8.	Нахождение расстояния между пространственными объектами;

SELECT top 100
    obj1.geom.STAsText() AS geometry1,
    obj2.geom.STAsText() AS geometry2,
    obj1.geom.STDistance(obj2.geom) AS distance_between_geometries

from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2


-- 11.	Создайте пространственный объект в виде точки (1) /линии (2) /полигона (3).

DECLARE @point geometry;
SET @point = geometry::STGeomFromText('POINT(1 1)', 0)
print(@point.STAsText());
DECLARE @line geometry;
SET @line = geometry::STGeomFromText('LINESTRING(0 0, 1 1, 2 1)', 0)
print(@line.STAsText());;
DECLARE @polygon geometry;
SET @polygon = geometry::STGeomFromText('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))', 0)
print(@polygon.STAsText());;

-- 12 

DECLARE @polygon1 geometry;
DECLARE @polygon2 geometry;

SET @polygon1 = geometry::STGeomFromText('LINESTRING(0 0, 1 1, 2 1)', 0)
SET @polygon2 = geometry::STGeomFromText('LINESTRING(0 0, 1 1, 2 1)', 0)
print(@polygon1.STIntersection(@polygon2).STAsText());

go
DECLARE @polygon geometry;
SET @polygon = geometry::STGeomFromText('POLYGON ((75.5023995300001 32.300586860000109, 75.537952915000119 32.345183621000032, 
75.573299595000037 32.374639187000128, 75.611953566000125 32.395464789000087, 
75.682646926000132 32.399805610000072, 75.6982532080001 32.406032620000062, 
75.705694615000084 32.412802232000089, 75.723161249000043 32.4242227240001, 
75.729362421000133 32.429622911000067, 75.732566359000089 32.437167670000107, 
75.736803827000131 32.45590037700002, 75.743004999000163 32.4643753120001, 
75.7976786640001 32.481118476000063, 75.8180391780001 32.494786892000079, 
75.82858117100011 32.497887478000024, 75.839123163000181 32.506569119000076, 
75.847391392000134 32.51674937600005, 75.8550395040001 32.526283678000127, 
75.8671317890001 32.547471015000085, 75.865891555000132 32.560570991000048, 
75.895553827000072 32.5968478460001, 75.9129171080001 32.610542101000121, 
75.920461867000085 32.614469509000088, 75.922632277000048 32.617337551000077, 
75.925732863000121 32.630566718000068, 75.926042922000192 32.641186225000055, 
75.924699335000128 32.651960761000083, 75.904855585000121 32.691312364000069, 
75.90144494000009 32.70286204700011, 75.903408645000127 32.736374213000104, 
75.913227167000116 32.755675361000058, 75.9124003440001 32.761902371000048,
75.909299758000031 32.772702745000089, 75.903305292000084 32.781616930000013, 
75.88666548000009 32.799729519000039, 75.880877720000115 32.8088504090001, 
75.876536900000133 32.817609565000083, 75.869612258000132 32.827402249000045, 
75.858553501000131 32.839546210000051, 75.824240350000139 32.870448717000045, 
75.811734654000134 32.884298001000104, 75.804913365000061 32.898612372000088, 75.803363072000138 32.911996568000035, 75.806877069000109 32.9236754420001, 75.814628534000121 32.9317886420001, 75.8264107600001 32.938067328000017, 75.846047805000126 32.942227281000044, 75.858553501000131 32.942149767000032, 75.869612258000132 32.94000519500014, 75.89379682800012 32.930806790000048, 75.903098586000169 32.928920600000126, 75.9116768740002 32.92589752900011, 75.9198417500001 32.920264797000073, 75.935964797000054 32.903237413000056, 75.943612909000137 32.898121446000061, 75.954671665000092 32.901377061000048, 75.972448358000065 32.911040554000067, 76.051409947000138 32.96946076100005, 76.0754911640002 32.993283596000111, 76.08169233600006 33.000802517000068, 76.1008126160001 33.013049832000092, 76.152799107000078 33.032299303000116, 76.194657017000054 33.0432805450001, 76.215947707000169 33.051083686000112, 76.2370316910002 33.063486030000092, 76.261733026000115 33.086456204000044, 76.270828078000136 33.103535265000076, 76.27423872300011 33.116609402000037, 76.2747554870001 33.126789659000096, 76.281060012000125 33.136453152000115, 76.294289178000156 33.147899482000128, 76.353303664000066 33.18009389900007, 76.396711867000135 33.19771556200007, 76.5121570170001 33.217223416000067, 76.542439406000142 33.232855536000017, 76.558562453000036 33.231460273000039, 76.611892531000137 33.193917345000031, 76.625948521000169 33.189292304000077, 76.7398433780001 33.197405504000074, 76.75451948400007 33.1945633000001, 76.768678827000031 33.1868118350001, 76.82945031100013 33.12554942500006, 76.8483638850002 33.114800727000045, 76.903037551000125 33.07376964000008, 76.927532180000071 33.0458643660001, 76.940141229000119 33.034288845000063, 76.956057570000041 33.025090440000056, 76.999879185000168 33.0072362330001, 77.088452590000088 32.950211290000112, 77.135788202000072 32.92675019000005, 77.219917434000138 32.90199717900002, 77.348695103000125 32.867244778000071, 77.371329380000191 32.867038072000113, 77.377737258000138 32.872205715000121, 77.384971958000108 32.884039618000131, 77.389002720000065 32.887682807000118, 77.393963658000132 32.889930732000039, 77.443986444000132 32.894478258000078, 77.477679478000141 32.901247870000105, 77.497833286000116 32.909257717000088, 77.538967727000113 32.918352769000066, 77.5535404800001 32.923417060000133, 77.5668730000001 32.929876614000094, 77.581032342000128 32.939049181000087, 77.607490676000111 32.962406928000036, 77.615758905000064 32.968298041000125, 77.624853957000141 32.971476142000085, 77.6433541200002 32.976049506000038, 77.65203576000016 32.980467841000035, 77.659993931000088 32.986488145000067, 77.67342980300009 32.999407254000076, 77.675186802000155 33.000414944000056, 77.694410435000179 33.008088894000139, 77.703298781000058 33.013256537000046, 77.712290480000092 33.014522610000085, 77.721075474000088 33.012636420000078, 77.7325476420001 33.001577664000067, 77.742159458000117 32.986953233000094, 77.765207147000069 32.962561957000077, 77.823808221000093 32.910342922000083, 77.8579146670001 32.873006700000133, 77.893468052000117 32.802959296000012, 77.910521275000065 32.790737820000089, 77.9227169130001 32.775183214000066, 77.928918085000191 32.7624449730001, 77.932328729000119 32.710871894000078, 77.9385299010001 32.695343126000068, 77.949381952000124 32.682708238000131, 77.97387658100007 32.660358181000063, 77.983178339000119 32.648059190000112, 77.988345982000112 32.633770657000042, 77.994650507000131 32.620360623000096, 78.008913202000087 32.610309557000065, 78.043226353000136 32.61139476200006, 78.05903934100013 32.618345242000132, 78.0698913920001 32.630360012000011, 78.077022740000132 32.640462755000058, 78.08405073400013 32.645139472000025, 78.0930424340001 32.648989366000066, 78.098830194000129 32.653769436000076, 78.104101190000051 32.661856798000073, 78.114643182000123 32.667722073000064, 78.131696405000184 32.67149445200009, 78.154537388000108 32.674052436000082, 78.178515253000114 32.688754381000081, 78.1915377140001 32.692009996000067, 78.208074172000124 32.692165025000094, 78.227917922000131 32.690175483000061, 78.243730910000124 32.692940172000107, 78.253859491000185 32.697901109000057, 78.268742303000124 32.7157036400001, 78.279387648000124 32.721491401000065, 78.305122512000082 32.729475409000131, 78.314320917000089 32.735444037000065, 78.317628208000087 32.743608914000077, 78.315457798000125 32.760507107000066, 78.31773156100013 32.764667060000093, 78.325172967000128 32.76673411700007, 78.333854608000081 32.767845160000064, 78.353284947000191 32.768620307000077, 78.360416294000117 32.7676126170001, 78.3666174660001 32.765209662000046, 78.370338169000092 32.761127224000049, 78.373438755000052 32.753970038000006, 78.3808801610001 32.72929454200009, 78.383360630000141 32.714437568000051, 78.384290806000081 32.699373888000068, 78.380570103000082 32.669194851000057, 78.377779576000137 32.657335110000133, 78.37467899000012 32.648782660000023, 78.3683744650001 32.639816799000073, 78.358555943000113 32.631677761000063, 78.332924432000141 32.617905992000118, 78.313390741000035 32.605038561000129, 78.3040889830001 32.596150214000104, 78.299438104000046 32.588657131000076, 78.2929268740001 32.575402127000075, 78.286518996000154 32.545093899000051, 78.2818681170001 32.532381497000088, 78.27401329900016 32.518868110000113, 78.27039594900009 32.504166165000115, 78.27401329900016 32.491143704000081, 78.282178176000173 32.480653388000036, 78.293650344000071 32.473289496000035, 78.30295210200012 32.470653998000017, 78.313390741000035 32.471739203000112, 78.358866001000081 32.515586656000025, 78.3809827070001 32.528041484000084, 78.384806762000039 32.547549337000063, 78.408164510000063 32.558375550000008, 78.447541952000108 32.566256205000045, 78.589858847000073 32.569925232000045, 78.63016646300008 32.578012594000043, 78.647736451000071 32.585970765000113, 78.664893026000129 32.599019063000057, 78.694451945000083 32.629663188000066, 78.7132621670001 32.637518006000008, 78.736826619000112 32.629844056000124, 78.750985962000129 32.612790833000091, 78.749125611000125 32.5958668010001, 78.74065067600003 32.578684387000024, 78.734966268000107 32.560649313000042, 78.736929973000031 32.545792338000084, 78.754706665000128 32.493805847000075, 78.771449829000119 32.461663106000046, 78.855682414000057 32.400452373000107, 78.881520630000125 32.376267802000129, 78.9112862550001 32.354744568000072, 78.943428996000137 32.346372986000105, 78.976191854000035 32.361617533000057, 78.989834432000123 32.364098003000024, 79.014742473000069 32.373994039000095, 79.028178345000072 32.377094626000044, 79.039650513000083 32.375983581000057, 79.0663155520001 32.370066631000057, 79.07530725100014 32.370790100000036, 79.0917403570001 32.390556335000028, 79.102902466000046 32.449855042000124, 79.112927694000064 32.472385967000051, 79.132874797000113 32.4854601040001, 79.16140018800013 32.496467184, 79.191165812000122 32.504270325000007, 79.215247030000057 32.507913513000105, 79.214316854000174 32.581164856000029, 79.219484497000053 32.621860047000069, 79.228889608000088 32.656121521000088, 79.240155070000185 32.701570943000036, 79.230336548000082 32.750999451000069, 79.2055843444019 32.809031276982765, 79.201186462951839 32.838214995808734, 79.211970134836136 32.919940028166032, 79.175972941000111 32.984783631000084, 79.17607629400004 32.993465271000048, 79.109310344000107 33.007908834000062, 79.095047648000161 33.055115255000089, 79.115821574000108 33.090048523000078, 79.139592733000029 33.124930115000069, 79.140212850000125 33.160250956000056, 79.125038241221887 33.290202603167643, 79.098028227253849 33.28765466454805, 79.075048157211455 33.295742554842192, 79.05327756453967 33.307872984457326, 79.023040630273357 33.317980386932611, 78.993448707391963 33.330781826020484, 78.964985716481976 33.344254148471954, 78.917694132000122 33.386257833000045, 78.915947775000063 33.387655981000094, 78.824263143000053 33.461059469000062, 78.800905396000076 33.494235738, 78.7813717040001 33.552785136000082, 78.79408410700006 33.743910421000024, 78.787262817000112 33.808428447000054, 78.770312948000083 33.872352193000026, 78.7211169840001 33.994386089000088, 78.730108684000072 34.079264629000036, 78.806073039000125 34.122982890000017, 78.90322473100008 34.158122864000077, 78.976191854000035 34.2171631880001, 78.985493612000141 34.239900818000095, 78.988490845000058 34.263129374000087, 78.985390259000042 34.286357931000012, 78.976191854000035 34.309173076000022, 78.956939516000034 34.339960905000041, 78.951180461000035 34.349170634000089, 78.922138306000136 34.372295837000067, 78.8858614500001 34.385757548000029, 78.839249308000035 34.396893820000045, 78.801732218000041 34.415006409000071, 78.750675904000047 34.471282044000063, 78.664582968000047 34.526420797000057, 78.6073254800001 34.546471253000092, 78.379432414000064 34.578665670000035, 78.3353007400001 34.594375306000089, 78.296026652000137 34.624657695000039, 78.2731856690001 34.658867493000045, 78.211380656000131 34.848261617000091, 78.202492309000093 34.86572825100005, 78.162184693000029 34.908826396000038, 78.148128703000054 34.943139547000058, 78.139240357000119 35.01894887300007, 78.130041951000123 35.055432434000082, 78.036404257000072 35.194235331000087, 78.0011609290001 35.268907776000091, 78.009842571000036 35.347455953000022, 78.038057902000048 35.398098856999994, 78.0556278900001 35.452875875000061, 78.044259074000081 35.491633198999992, 77.985864706000029 35.494165344000081, 77.957856079000123 35.482073059000086, 77.912690877000045 35.440990295000049, 77.883131958000035 35.431068420000045, 77.857087036000053 35.43659779900004, 77.834246053000072 35.452152405000064, 77.815332479000119 35.473339742000022, 77.800346314000137 35.495405579000121, 77.424658651000072 35.302923788000115, 77.048970988000065 35.110441997000024, 77.042426147000072 35.107013744000071, 77.023132772000054 35.086334941000061, 77.027060180000035 35.062098694, 77.035225057000048 35.034503479000094, 77.028610474000061 35.003394267000132, 77.013107544000036 34.986392721000115, 76.95295617700009 34.9465501910001, 76.933835897000108 34.9288768520001, 76.921123495000131 34.92071197500006, 76.905930623000131 34.923140768000039, 76.879575643000067 34.937093404000038, 76.852600546000133 34.94334625300003, 76.817047160000072 34.940762431000039, 76.782010539000055 34.930892233000051, 76.757619263000038 34.915130920000067, 76.749557739000124 34.892083232000104, 76.753278442000067 34.838339743000077, 76.743873332000078 34.819271138000104, 76.6526127520001 34.74697581000008, 76.639590291000047 34.741136374000078, 76.553187297000079 34.725840149000121, 76.53582401500006 34.726201885000123, 76.519907674000137 34.731111145000071, 76.476499471000125 34.757776184000093, 76.438155558000119 34.762892151000088, 76.399914998000042 34.750748190000095, 76.262042277000091 34.68465403200004, 76.154968709000059 34.661658021000093, 76.121792440000092 34.66088287400008, 76.058333781000044 34.6834137980001, 76.023400513000126 34.6771609500001, 76.007484172000034 34.665120341000019, 75.986710246000086 34.636026510000121, 75.973377727000127 34.622332256000007, 75.9662463790001 34.619076640000017, 75.93927128100006 34.612048646000105, 75.873952270000132 34.571379293000049, 75.81617801900012 34.521666565000046, 75.795817505000116 34.507920635000019, 75.777110637000135 34.503812358000104, 75.734839315000045 34.5086182670001, 75.7136519770001 34.50851491300007, 75.65556766800006 34.496965231000033, 75.611642701000051 34.498360494000011, 75.348092896000125 34.557219951000029, 75.306958456000075 34.574014791000067, 75.267477661000044 34.59830271400007, 75.251354615000082 34.6130821740001, 75.23688521300005 34.631892395000094, 75.224543845000142 34.638621632000067, 75.212907349000034 34.644966532000055, 75.1763204350001 34.645379944000055, 75.111001424000051 34.633649394000074, 75.017777140000078 34.629721985000018, 74.66493046100004 34.68832306000003, 74.412129354000058 34.764494121000027, 74.348877400000049 34.773434143000046, 74.285832153000115 34.768886617000121, 74.221753377000084 34.747750956000075, 74.146822551000071 34.701862285000018, 74.120880981000084 34.690855204000016, 73.962234335000119 34.668169251000066, 73.9485917560001 34.662743225000085, 73.919342895000057 34.642537741000083, 73.917482544000052 34.619283346000074, 73.9254407140001 34.593393454000037, 73.925957479000033 34.564971415000016, 73.910971313000061 34.544972636000082, 73.863118938000071 34.517067363000095, 73.846995890000073 34.494329733000129, 73.846995890000073 34.49417470300007, 73.845548950000079 34.456476746000035, 73.840381307000087 34.444410299000069, 73.831596313000091 34.436400452000086, 73.806791626000063 34.425160828000045, 73.7962496340001 34.418546244000126, 73.779816529000129 34.396066996000016, 73.774855591000062 34.370952250000087, 73.782710409000117 34.346819357000058, 73.80420780500009 34.327492371000076, 73.829115845000047 34.315348409000094, 73.853300415000092 34.307416077000042, 73.8790352790001 34.304289653000083, 73.907457316000034 34.306795960000059, 73.937739705000126 34.304212138000068, 73.954379517000064 34.287184753000034, 73.976703736000047 34.237549540000046, 73.990553019000117 34.21850677500008, 73.998304484000073 34.196802674000068, 73.995410604000085 34.176442159000047, 73.976703736000047 34.161559347000022, 73.916862427000069 34.135256042000051, 73.893297974000063 34.114740499000092, 73.884409627000139 34.084199728000087, 73.893711385000074 34.054304911000074, 73.91624231000003 34.027949931000094, 73.94580122900004 34.009785665000081, 73.976703736000047 34.004592183000071, 74.045019979000074 34.019423320000087, 74.065277140000092 34.018338115000077, 74.11840051300004 34.002525127000084, 74.154263957000069 34.004101258000034, 74.192091105000031 34.011852722000029, 74.228367961000117 34.012886251000012, 74.259683878000033 33.994386089000088, 74.272292928000127 33.962139995000129, 74.262474406000081 33.929945578000073, 74.239530070000058 33.9010067760001, 74.212554972000135 33.878424174000074, 74.177518351000117 33.8575468960001, 74.142275024000128 33.844240215000085, 74.034581340000045 33.828608093000057, 74.011326946000054 33.810469666000117, 73.976703736000047 33.758922425000023, 73.9707092700001 33.747062683000095, 73.966161743000043 33.734531148000073, 73.963061157000141 33.721560364000069, 73.960787395000125 33.692285665, 73.963061157000141 33.676756897000089, 73.968332154000052 33.662080790000104, 73.976703736000047 33.648386536000075, 74.02424605300007 33.614254252000094, 74.088118123000072 33.585289613000029, 74.141551555000035 33.54937449100008, 74.157777954000039 33.494235738, 74.136280558000067 33.418013000000073, 74.105481405000035 33.345200907000006, 74.095972941000127 33.328483582000061, 74.085120891000088 33.31432424000009, 74.071995077000111 33.302283631000037, 74.055355265000117 33.292025859000049, 74.017838176000112 33.279494324000055, 74.001715129000047 33.270166728000007, 73.991793253000139 33.252570903000034, 73.988485962000141 33.208620097000093, 74.002335246000086 33.177691752000086, 74.029413697000052 33.154153136999994, 74.065793905000135 33.132604065000024, 74.0984534100001 33.104827983000078, 74.153850546000058 33.040180766000034, 74.190850871000123 33.022094015000008, 74.28397180200011 33.008813171, 74.311256958000115 32.994292095000063, 74.322005656000044 32.972045390000105, 74.324486125000135 32.921402486000048, 74.336681763000058 32.870139466000026, 74.33378788300007 32.849262187000036, 74.3229358320001 32.830529480000067, 74.316988541000057 32.823067314000085, 74.315938653000046 32.821750002000087, 74.306502726000133 32.809910584000065, 74.316321248000122 32.791074524000052, 74.329343709000057 32.776424256000055, 74.346190226000033 32.766889954000064, 74.367687622000062 32.763530986000049, 74.386394491000033 32.767768454000091, 74.418950643000073 32.784614971000067, 74.438691040000037 32.785984395000057, 74.455330852000088 32.778594666000046, 74.4844763590001 32.75353159600003, 74.500909465000063 32.7460126750001, 74.520959920000109 32.745289205000105, 74.573773234000043 32.752549744000063, 74.593410278000079 32.757872416000012, 74.6140808510001 32.770403951000034, 74.622039022000081 32.7854159540001, 74.626276489000134 32.802650045000078, 74.635888305000037 32.822080384000074, 74.653561646000128 32.83742828400004, 74.671751750000055 32.840580546000083, 74.685290975000044 32.831227112000036, 74.689115031000085 32.808825378000066, 74.682293742000127 32.787327983000026, 74.656972290000056 32.745340882000008, 74.649737590000086 32.723145854000066, 74.6501510010001 32.701235047000026, 74.65728234900007 32.660591533000073, 74.656042114000115 32.640670268000079, 74.647980591000135 32.623617046000035, 74.636921834000134 32.6062537640001, 74.629583781000122 32.588089498000087, 74.632581014000039 32.568168233000065, 74.6625533450001 32.4983792120001, 74.689321737000057 32.471352438000068, 74.724978475000057 32.460810445000007, 74.7635290930001 32.462670797, 74.799392538000063 32.47267018700002, 74.83814986200008 32.474866435000123, 74.9069828690001 32.445178324000054, 74.948427369000058 32.448769836000039, 74.990698690000045 32.463368429000084, 75.023668254000086 32.466262309000072, 75.054880819000061 32.455539450000074, 75.092191203000084 32.429339498000061, 75.125987590000079 32.411743673000061, 75.196164185000043 32.397300110000046, 75.230167277000078 32.3801952110001, 75.298402936000059 32.332426605000094, 75.327113072000031 32.339964301000109, 75.390365025000108 32.335494290000085, 75.414136184000085 32.346010444000058, 75.42271447100012 32.353994452000023, 75.436770461000037 32.3602214630001, 75.44193810400003 32.359756375000089, 75.444418573000121 32.3531934680001, 75.442041457000187 32.336191922000083, 75.444728631000089 32.330300808000075, 75.451446568000108 32.324022122000073, 75.464779087000124 32.317743435000068, 75.4741841980001 32.312136542000047,
75.4806954280001 32.30745982500008, 75.5023995300001 32.300586860000109))', 0);
select obj1.geom.STIntersection(@polygon).STAsText() from [dbo].[10m_admin_0_map_units] obj1
print(@polygon.STAsText());


select top 100 obj1.geom.STIntersection(obj2.geom).STAsText()  Intersection1
from [dbo].[10m_admin_0_map_units] obj1,[dbo].[10m_admin_0_breakaway_disputed_areas] obj2 ;
